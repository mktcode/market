<p style="color: green"><%= notice %></p>

<div id="<%= dom_id @product %>" class="max-w-screen-lg mx-auto px-4 py-8">
  <div class="flex justify-between items-center mb-4">
    <div class="mb-4">
      <h1 class="text-5xl mb-2">
        <%= @product.title %>
      </h1>
      <p class="text-3xl text-gray-600">
        <%= @product.description %>
      </p>
    </div>
  </div>

  <div class="flex space-x-3 items-start" data-controller="lightbox">
    <% if @product.ordered_images.any? %>
      <div class="w-1/3">
        <%= link_to @product.ordered_images.first, data: { lightbox: "product-gallery" } do %>
          <div class="relative aspect-square w-full group overflow-hidden rounded-lg">
            <%= image_tag @product.ordered_images.first, class: "w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" %>
            <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-300 flex items-center justify-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="size-24 text-white opacity-0 group-hover:opacity-50 transition-opacity duration-300"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
              </svg>
            </div>
          </div>
        <% end %>
      </div>
      <div class="w-24 flex flex-col space-y-3">
        <% @product.ordered_images.each_with_index do |image, index| %>
          <% next if index.zero? %>
          <%= link_to image, data: { lightbox: "product-gallery" } do %>
            <div class="relative aspect-square w-full group overflow-hidden rounded-lg">
              <%= image_tag image, class: "w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" %>
              <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-300 flex items-center justify-center">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="size-8 text-white opacity-0 group-hover:opacity-50 transition-opacity duration-300"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                </svg>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    <% end %>
    <div class="pl-4 grow">
      <div>
        <h1 class="text-xl leading-none">Zeitaufwand</h1>
        <p class="text-2xl font-semibold">
          <%= @product.time_invested %> Stunden
        </p>
      </div>

      <div class="mt-4">
        <div class="bg-white grid grid-cols-3 rounded-lg shadow-sm text-lg">
          <% @product.materials.each do |material| %>
            <div class="p-3 col-span-2 flex items-center">
              <%= material.name %>
              <% if material.secondhand? %>
                <span class="text-sm text-gray-500 ml-3">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-3 text-gray-400 inline-block">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
                  </svg>
                  wiederverwendet
                </span>
              <% end %>
            </div>
            <div class="p-3 text-right">
              <%= number_to_currency material.cost, unit: "â‚¬", format: "%n %u" %>
            </div>
          <% end %>
          <div class="p-3 text-xl col-span-2">
            Gesamtkosten:
          </div>
          <div class="p-3 text-xl text-right">
            <span class="font-semibold">
              <%= number_to_currency @product.materials.sum(&:cost), unit: "â‚¬", format: "%n %u" %>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-4 prose-xl">
    <%= @product.body %>
  </div>
</div>
