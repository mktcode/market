<p style="color: green"><%= notice %></p>

<div id="<%= dom_id @product %>">
  <div class="flex justify-between items-center mb-4">
    <div class="prose-xl">
      <h1>
        <%= @product.title %>
      </h1>
      <p>
        <%= @product.description %>
      </p>
    </div>
    <div class="flex space-x-3 items-center">
      <% if authenticated? %>
        <%= link_to edit_product_path(@product) do %>
          <button class="secondary">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 mr-2">
              <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
            </svg>

            Produkt bearbeiten
          </button>
        <% end %>
      <% end %>
    </div>
  </div>

  <% if @product.ordered_images.any? %>
    <div class="flex space-x-3 items-start" data-controller="lightbox">
      <div class="w-1/3">
        <%= link_to @product.ordered_images.first, data: { lightbox: "product-gallery" } do %>
          <div class="relative aspect-square w-full group overflow-hidden rounded-lg">
            <%= image_tag @product.ordered_images.first, class: "w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" %>
            <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-300 flex items-center justify-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="size-24 text-white opacity-0 group-hover:opacity-50 transition-opacity duration-300"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
              </svg>
            </div>
          </div>
        <% end %>
      </div>
      <div class="w-24 flex flex-col space-y-3">
        <% @product.ordered_images.each_with_index do |image, index| %>
          <% next if index.zero? %>
          <%= link_to image, data: { lightbox: "product-gallery" } do %>
            <div class="relative aspect-square w-full group overflow-hidden rounded-lg">
              <%= image_tag image, class: "w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" %>
              <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-300 flex items-center justify-center">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="size-8 text-white opacity-0 group-hover:opacity-50 transition-opacity duration-300"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                </svg>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>

  <div class="mt-4 prose-xl">
    <%= @product.body %>
  </div>

  <div class="mt-4">
    <h1 class="text-2xl mb-2 font-semibold">Zeitaufwand</h1>
    <p>
      <%= @product.time_invested %> Stunden
    </p>
  </div>


  <div class="mt-4">
    <h1 class="text-2xl mb-2 font-semibold">Materialien</h1>
    <table class="border-collapse table-auto w-full prose-lg">
      <thead>
        <tr class="text-left">
          <th>Bezeichnung</th>
          <th>Kosten</th>
          <th>Gebraucht</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200 bg-white">
        <% @product.materials.each do |material| %>
          <tr>
            <td class="px-3">
              <%= material.name %>
            </td>
            <td class="px-3">
              <%= number_to_currency material.cost, unit: "â‚¬", format: "%n %u" %>
            </td>
            <td class="px-3">
              <% if material.secondhand? %>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-green-600">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                </svg>
              <% else %>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-red-600">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
